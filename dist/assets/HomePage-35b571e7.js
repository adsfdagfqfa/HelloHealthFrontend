import{_ as j,u as Z,o as n,c as i,n as C,k as l,a as e,t as b,p as A,d as q,e as L,f,r as $,F as T,l as U,b as d,w as _,i as R,j as m,m as ee,q as te,s as y,g as P,v as oe,x as ne,y as J,z as se,A as ae,h as ie}from"./index-96eb2e51.js";import{c as le}from"./changeTheme-5bb595fb.js";import{U as ce}from"./UserInfoCard-c27ee96e.js";import{g as V}from"./global-65bc9685.js";const re="/static/logo.png",K="/static/titleImg1.png";const ue=o=>(A("data-v-a9172b49"),o=o(),q(),o),de=ue(()=>e("span",{class:"redDot heartbeat"},null,-1)),_e=[de],fe={class:"buttonTxt"},pe={__name:"LinkButtonWithIcon",props:{fontColor:String,icon:String,text:String,hasNotification:Boolean},setup(o){return Z(w=>({a0c22b2a:o.fontColor})),(w,c)=>(n(),i("div",{class:C(["buttonHolder",{hasNotification:o.hasNotification}])},[o.icon!==""?(n(),i("i",{key:0,class:C(["icon fi",o.icon])},_e,2)):l("",!0),e("div",fe,b(o.text),1)],2))}},W=j(pe,[["__scopeId","data-v-a9172b49"]]);const B=o=>(A("data-v-03288de9"),o=o(),q(),o),he=B(()=>e("p",{class:"title"}," 消息通知 ",-1)),ge={class:"messageWrapper"},me={key:0,class:"messagePlaceHolder"},ve=["onClick"],ke={class:"content"},Ie={key:0,class:"dotWrapper"},xe=B(()=>e("span",{class:"unreadDot"},null,-1)),ye=[xe],be={key:0,class:"goButton"},Ce=B(()=>e("i",{class:"fi fi-rr-angle-small-right centerIcon"},null,-1)),we=[Ce],Se={key:0,class:"messageControls"},He=B(()=>e("i",{class:"fi fi-rr-trash centerIcon"},null,-1)),$e=B(()=>e("span",null,"清除已读消息",-1)),Be={__name:"NotificationPopup",setup(o,{expose:w}){const c=L({data:[]}),p=L({data:[]}),v=f(!1),h=f(!0),r=f(!1),M=()=>{r.value=!r.value,h.value=!1,k(),setTimeout(()=>{h.value=!0},0)},k=()=>{c.data=[];for(let a of p.data)(r.value||a.unread)&&c.data.push(a)};w({getNotification:()=>{v.value=!0,r.value=!1,R.get("/toDoListService/api/notification/getNotices?userId="+localStorage.getItem("userId"),{doNotShowLoadingScreen:!0}).then(a=>{v.value=!1,h.value=!1,p.data=a.json.notifications,k(),setTimeout(()=>{h.value=!0},0)}).catch(a=>{a.network||a.defaultHandler("消息加载失败")})}});const x=a=>{a&&m.push("/"+a)},S=()=>{p.data=[],c.data=[],R.post("/toDoListService/api/notification/clearNotices",{userId:localStorage.getItem("userId")},{doNotShowLoadingScreen:!0})};return(a,z)=>{const H=$("el-button");return n(),i(T,null,[he,e("div",ge,[c.data.length===0?(n(),i("p",me,b((()=>{if(v.value)return"加载中";if(p.data.length===0)return"没有消息";if(c.data.length===0)return"没有新消息"})()),1)):l("",!0),h.value?(n(!0),i(T,{key:1},U(c.data,s=>(n(),i("div",{class:C(["messageEntry",{clickable:s.url}]),onClick:F=>x(s.url)},[e("div",ke,[s.unread?(n(),i("span",Ie,ye)):l("",!0),e("span",null,b(s.message),1)]),s.url?(n(),i("div",be,we)):l("",!0)],10,ve))),256)):l("",!0)]),p.data.length>0?(n(),i("p",Se,[d(H,{class:"clearButton",onClick:M,link:""},{default:_(()=>[e("i",{class:C(["fi centerIcon",{"fi-rr-angle-down":!r.value," fi-rr-angle-up":r.value}])},null,2),e("span",null,b(r.value?"收起":"展开全部"),1)]),_:1}),d(H,{class:"clearButton",onClick:S,link:""},{default:_(()=>[He,$e]),_:1})])):l("",!0)],64)}}},Ne=j(Be,[["__scopeId","data-v-03288de9"]]);const N=o=>(A("data-v-4be6147b"),o=o(),q(),o),Pe={class:"pageWrapper"},Le={class:"headerHolder"},Te=N(()=>e("div",{class:"leftTitle"},[e("img",{alt:"",src:re})],-1)),Me={key:0,class:"rightTitle"},De=N(()=>e("img",{alt:"",src:K},null,-1)),Ee=N(()=>e("div",{class:"line"},null,-1)),Ve={key:1,class:"rightTitle"},We=N(()=>e("img",{alt:"",src:K},null,-1)),Ue={class:"contentHolder"},Re={class:"sideBar"},je={class:"userInfoWrapper"},Ae=["src"],qe={class:"beian"},ze={class:"content"},Fe=N(()=>e("div",{class:"area"},[e("ul",{class:"circles"},[e("li"),e("li"),e("li"),e("li"),e("li"),e("li"),e("li"),e("li"),e("li"),e("li")])],-1)),Oe={__name:"HomePage",setup(o){le("#00bfa8");function w(){m.push("/login")}const c=t=>{m.push(t.index)},p=async()=>{localStorage.clear(),window.location.href="/"},v=f(),h=()=>{I.data.unread_notification=!1},r=()=>{v.value.getNotification()},M=()=>{x.value||m.push("/login")},k=L({v:[{title:"HH 首页",icon:"fi-rr-home",path:"/"},{title:"HH 找药",icon:"fi-rr-capsules",path:"/medicine"},{title:"健康资讯",icon:"fi-rr-books",path:"/news"},{title:"HH 论坛",icon:"fi-rr-user-md-chat",path:"/forum"}]});let I=L({data:{user_phone:"",user_name:"未登录",user_id:123456,user_group:"none",avatar_url:"/static/defaultAvatar.png",unread_notification:!1,verified:!1}});const x=f(!1),S=f(!0),a=f(!1),z=localStorage.getItem("userId");R.get("/userInfoService/user/getUserInfo?userId="+z).then(t=>{let u=t.json;x.value=u.login,a.value=!0,u.login&&(k.v=[{title:"HH 首页",icon:"fi-rr-home",path:"/"},{title:"HH 找药",icon:"fi-rr-capsules",path:"/medicine"},{title:"收藏管理",icon:"fi-rr-followcollection",path:"collection",children:[{title:"药品收藏",icon:"fi-rr-capsules",path:"/medicineCollection"},{title:"帖子收藏",icon:"fi-rr-memo",path:"/postCollection"}]},{title:"健康资讯",icon:"fi-rr-books",path:"/news"},{title:"HH 论坛",icon:"fi-rr-user-md-chat",path:"/forum"},{title:"健康日历",icon:"fi-rr-calendar-clock",path:"/calendar"},{title:"个人中心",icon:"fi-rr-user-gear",path:"/user"}],S.value=!1,setTimeout(()=>{S.value=!0},0),V.login=!1,V.locked=u.locked,I.data=u,V.userInfo=I.data)}).catch(t=>{t.network||t.defaultHandler()});const H=()=>{let t=m.currentRoute.value.path.split("/");return t.length===1?"":"/"+t[1]};let s="/static/menu_main.png";const F=()=>{let t=m.currentRoute.value.path;t.includes("Collection")?s="/static/menu_collection.png":t.includes("medicine")?s="/static/menu_medicine.png":t.includes("news")?s="/static/menu_news.png":t.includes("forum")?s="/static/menu_forum.png":t.includes("calendar")?s="/static/menu_calendar.png":t.includes("user")?s="/static/menu_profile.png":t.includes("coin")||t.includes("UserAgreement")?s="/static/menu_coin.png":s="/static/menu_main.png",console.log(t),console.log(s)},O=f();let G;return ee(()=>{(()=>{let t=H();for(let u of k.v)if(u.children)for(let D of u.children)D.path===t&&O.value.open(u.path);G=document.querySelector(".content")})()}),te(m.currentRoute,()=>{G.scrollTo({left:0,top:0}),F()}),(t,u)=>{const D=$("el-popover"),Q=$("el-menu"),X=$("el-link"),Y=$("RouterView");return n(),i("div",Pe,[e("div",Le,[Te,x.value?(n(),i("div",Me,[De,d(D,{width:360,"popper-style":"box-shadow: 0 5px 20px hsla(0,0%,7%,.1);padding: 0; transition: opacity 0.3s;",trigger:"click",onBeforeEnter:r},{reference:_(()=>[d(W,{"font-color":"#fff",text:"消息通知",icon:"fi-rr-bell","has-notification":y(I).data.unread_notification,onClick:h},null,8,["has-notification"])]),default:_(()=>[d(Ne,{ref_key:"notificationBox",ref:v},null,512)]),_:1}),Ee,d(W,{"font-color":"#fff",text:"退出",icon:"",onClick:p})])):l("",!0),x.value?l("",!0):(n(),i("div",Ve,[We,d(W,{"font-color":"#fff",text:"点击登录",icon:"",onClick:w})]))]),e("div",Ue,[e("div",Re,[e("div",je,[d(ce,{"user-info":y(I).data,showAvatarBorder:"",onClick:M},null,8,["user-info"])]),S.value?(n(),P(Q,{key:0,"default-active":H(),class:"sideBarMenu",ref_key:"menu",ref:O},{default:_(()=>[(n(!0),i(T,null,U(k.v,g=>(n(),P(oe(g.children?y(ne):y(J)),se({index:g.path},ae(g.children?{}:{click:c})),{title:_(()=>[e("i",{class:C(["fi",g.icon])},null,2),e("span",null,b(g.title),1)]),default:_(()=>[g.children?(n(!0),i(T,{key:0},U(g.children,E=>(n(),P(y(J),{index:E.path,onClick:c},{default:_(()=>[e("i",{class:C(["fi",E.icon])},null,2),e("span",null,b(E.title),1)]),_:2},1032,["index"]))),256)):l("",!0)]),_:2},1040,["index"]))),256))]),_:1},8,["default-active"])):l("",!0),e("img",{class:"menuImg",alt:"",src:y(s)},null,8,Ae),e("div",qe,[d(X,{href:"https://beian.miit.gov.cn/",target:"_blank",type:"info"},{default:_(()=>[ie("赣ICP备2023008902号-1")]),_:1})])]),e("div",ze,[a.value?(n(),P(Y,{key:0})):l("",!0)]),Fe])])}}},Xe=j(Oe,[["__scopeId","data-v-4be6147b"]]);export{Xe as default};
