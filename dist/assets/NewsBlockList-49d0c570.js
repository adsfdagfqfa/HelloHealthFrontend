import{_ as L,r as s,o as _,g as m,w as a,b as l,a as g,t as w,V as C,i as N,c as x,l as v,F as T}from"./index-96eb2e51.js";const S={name:"NewsBlock",props:{flash_id:{type:Number},flash_title:{type:String},flash_date:{type:String},flash_content:{type:String},flash_image:{type:String}},computed:{truncatedTitle:function(){return this.flash_title.length>15?this.flash_title.substring(0,15)+"...":this.flash_title},truncatedContent:function(){return this.flash_preview.length>50?this.flash_preview.substring(0,50)+"...":this.flash_preview}},methods:{goFullContent(){this.$router.push("/news/"+this.$props.flash_id)}}},B=["src"],I={class:"flash-date"};function F(e,t,o,h,r,n){const d=s("el-aside"),u=s("el-header"),c=s("el-container"),f=s("el-card");return _(),m(f,{shadow:"hover",class:"news-block-card"},{default:a(()=>[l(c,{class:"news-block"},{default:a(()=>[l(d,{width:"120px"},{default:a(()=>[g("img",{class:"flash-image",src:o.flash_image},null,8,B)]),_:1}),l(c,null,{default:a(()=>[l(u,{class:"flash-header"},{default:a(()=>[g("h1",{onClick:t[0]||(t[0]=(...p)=>n.goFullContent&&n.goFullContent(...p)),class:"flash-title clickable",style:{"font-weight":"bold"}},w(n.truncatedTitle),1),g("span",I,w(o.flash_date),1)]),_:1})]),_:1})]),_:1})]),_:1})}const z=L(S,[["render",F],["__scopeId","data-v-15abc8bc"]]);const V={name:"NewsBlockList",components:{NewsBlock:z},props:{selectedTagId:{type:Number,default:null}},data(){return{newsList:[],page:1,pageSize:4,input:""}},computed:{Search(){return C},currentNewsList(){if(this.filteredNewsList&&this.filteredNewsListTotal>0){let e=(this.page-1)*this.pageSize,t=e+this.pageSize;return this.filteredNewsList.slice(e,t)}else return[]},filteredNewsList(){return this.input===""?this.newsList:this.newsList.filter(e=>e.flashTitle.includes(this.input))},filteredNewsListTotal(){return this.filteredNewsList.length}},methods:{handlePageChange(e){this.page=e,console.log("page changed")},getNewsList(){this.selectedTagId!=null?N.get("/FlashService/flash/newsByTag/"+this.selectedTagId).then(e=>{this.newsList=e.data.data,this.newsList.forEach(t=>{t.preview=this.getContentText(t.content)})}):N.get("/FlashService/flash").then(e=>{this.newsList=e.data.data,this.newsList.forEach(t=>{t.preview=this.getContentText(t.content)})})},getContentText(e){e=JSON.parse(e);let t=[];if(e&&Array.isArray(e.content)){for(const o of e.content)if(o.type==="paragraph"&&Array.isArray(o.content)){let h=o.content.map(r=>r.text).join(" ");t.push(h)}}return t.join(" ")}},mounted(){this.getNewsList()},watch:{selectedTagId(){this.page=1,this.getNewsList()}}};function A(e,t,o,h,r,n){const d=s("el-input"),u=s("el-col"),c=s("el-row"),f=s("NewsBlock"),p=s("el-main"),y=s("el-pagination"),b=s("el-footer"),k=s("el-container");return _(),m(k,{class:"news-container"},{default:a(()=>[l(p,null,{default:a(()=>[l(c,{class:"result_title"},{default:a(()=>[l(u,null,{default:a(()=>[l(d,{class:"search-box",placeholder:"根据关键词查找新闻","suffix-icon":n.Search,onChange:n.filteredNewsList,modelValue:this.input,"onUpdate:modelValue":t[0]||(t[0]=i=>this.input=i),modelModifiers:{change:!0},clearable:""},null,8,["suffix-icon","onChange","modelValue"])]),_:1})]),_:1}),(_(!0),x(T,null,v(n.currentNewsList,i=>(_(),m(f,{class:"flash tilt-in-left-1",key:i.flashId,flash_title:i.flashTitle,flash_date:i.flashTime,flash_image:i.flashImage,flash_id:i.flashId},null,8,["flash_title","flash_date","flash_image","flash_id"]))),128))]),_:1}),l(b,null,{default:a(()=>[l(y,{class:"footer",background:"",page:r.page,"onUpdate:page":t[1]||(t[1]=i=>r.page=i),"page-size":r.pageSize,total:+n.filteredNewsListTotal,layout:"prev, pager, next",onCurrentChange:n.handlePageChange},null,8,["page","page-size","total","onCurrentChange"])]),_:1})]),_:1})}const j=L(V,[["render",A],["__scopeId","data-v-359b2117"]]);export{j as N};
